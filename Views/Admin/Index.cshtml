
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";

    
}
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">

<link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">

<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

<link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">

<link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">

<link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">

<link rel="stylesheet" href="dist/css/adminlte.min.css?v=3.2.0">

<link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">

<link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">

<link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">






<div class="row">
    <div class="col-lg-3 col-6">
        <div class="small-box bg-info">
            <div class="inner">
                <h3>@ViewBag.CXL</h3>
                <p>Đơn hàng chờ xử lý</p>
            </div>
            <div class="icon">
                <i class="ion ion-bag"></i>
            </div>
            <a href="~/SanPham/HoaDon_ChuaXuLy" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <div class="col-lg-3 col-6">

        <div class="small-box bg-info">
            <div class="inner">
                <h3>@ViewBag.TB</h3>
                <p>Yêu cầu đơn hàng</p>
            </div>
            <div class="icon">
                <i class="ion ion-bag"></i>
            </div>
            <a href="~/SanPham/ThongBao" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <div class="col-lg-3 col-6">

        <div class="small-box bg-success">
            <div class="inner">
                <h3>@ViewBag.S</h3>
                <p>Voucher</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
            <a href="~/SanPham/KhoVoucher" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>

    <div class="col-lg-3 col-6">

        <div class="small-box bg-danger">
            <div class="inner">
                <h3>@ViewBag.SoKH</h3>
                <p>Thành viên</p>
            </div>
            <div class="icon">
                <i class="ion ion-person-add"></i>
            </div>
            <a href="~/NguoiDung/Index" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>

</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">BÁO CÁO THỐNG KÊ</h5>
              
            </div>

            <div class="card-body">
                <div class="row">
                    <div class="col-md-8">
                        <p class="text-center">
                            <strong>Doanh thu 12 tháng</strong>
                        </p>
                        <div class="chart">
                            
                            <canvas id="revenueChart" width="600" height="400"></canvas>

                        </div>

                    </div>

                    @{
                        int completed = ViewBag.DXL; // Số công việc đã hoàn thành
                        int total = ViewBag.DXL + ViewBag.CXL; // Tổng số công việc
                        double percentage = (double)completed / total * 100; // Tính toán tỷ lệ phần trăm hoàn thành
                    }


                    <div class="col-md-4">
                        <p class="text-center">
                            <strong>Tiến trình</strong>
                        </p>
                        <div class="progress-group">
                            Xử lý đơn hàng
                            <span class="float-right">
                                <b>@ViewBag.DXL / @(ViewBag.DXL+ViewBag.CXL)
                            </b></span>
                            <div class="progress progress-sm">
                                <div class="progress-bar bg-warning" style="width: @percentage%">@Math.Round(percentage,1) %</div>
                            </div>
                        </div>


                        @{
                            int completed_dg = ViewBag.DG; // Số công việc đã hoàn thành
                            int total1 = ViewBag.DXL + ViewBag.CXL + ViewBag.DG; // Tổng số công việc
                            double percentage1 = (double)completed_dg / total1 * 100; // Tính toán tỷ lệ phần trăm hoàn thành
                        }
                        <div class="progress-group">
                            Đơn hàng giao thành công
                            <span class="float-right"><b>@ViewBag.DG/ @(ViewBag.DXL + ViewBag.CXL + ViewBag.DG)</b></span>
                            <div class="progress progress-sm">
                                <div class="progress-bar bg-success" style="width: @percentage1%">@Math.Round(percentage1,1) %</div>
                            </div>
                        </div>


                        @{
                            int donct = ViewBag.MT; // Số công việc đã hoàn thành
                            double per1 = (double)donct / 50 * 100; // Tính toán tỷ lệ phần trăm hoàn thành
                        }
                        <div class="progress-group">
                            <span class="progress-text">Chỉ tiêu đặt ra</span>
                            <span class="float-right"><b>@ViewBag.MT / 50 đơn</b></span>
                            <div class="progress progress-sm">
                                <div class="progress-bar bg-danger" style="width: @per1%">@Math.Round(per1,1) %</div>
                            </div>
                        </div>


                        @{
                            int c = ViewBag.SP; // Số công việc đã hoàn thành
                            int t = ViewBag.SP_ALL; // Tổng số công việc
                            double p1 = (double)c / t * 100; // Tính toán tỷ lệ phần trăm hoàn thành
                        }
                        
                        <div class="progress-group">
                            Sản phẩm đã áp dụng voucher
                            <span class="float-right"><b>@ViewBag.SP / @ViewBag.SP_ALL</b></span>
                            <div class="progress progress-sm">
                                <div class="progress-bar bg-success" style="width: @p1%">@Math.Round(p1,1) %</div>
                            </div>
                        </div>

                    </div>

                </div>

            </div>

            <div class="card-footer">
                <div class="row">
                    <div class="col-sm-3 col-6">
                        <div class="description-block border-right">
                            <span class="description-text">TỔNG DOANH THU</span>
                            @*<span class="description-percentage text-success"><i class="fas fa-caret-up"></i> 17%</span>*@
                            <h5 class="description-header">@string.Format("{0:N0}", ViewBag.TongDoanhThu) VND</h5>
                            
                        </div>

                    </div>

                    <div class="col-sm-3 col-6">
                        <div class="description-block border-right">
                            <span class="description-text">DOANH THU TRUNG BÌNH / THÁNG</span>
                            @*<span class="description-percentage text-warning"><i class="fas fa-caret-left"></i> 0%</span>*@
                            <h5 class="description-header">@string.Format("{0:N0}", ViewBag.DoanhThuTB) VND</h5>
                            
                        </div>

                    </div>


                    @{
                        int ht = ViewBag.HienTai; // Số công việc đã hoàn thành
                        int tt = ViewBag.ThangTruoc; // Tổng số công việc
                        int tong = ViewBag.TongDoanhThuhs;
                        double hsht = (double)(ht) / tong * 100; // Tính toán tỷ lệ phần trăm hoàn thành
                        double hstt = (double)(tt) / tong * 100;
                    }
                    <div class="col-sm-4 col-10">
                        <div class="description-block border-right">
                            <span class="description-text">HIỆU SUẤT DOANH THU SO VỚI THÁNG TRƯỚC</span>
                            <br>
                            @if(ht<tt){
                                <span class="description-percentage text-danger"><i class="fas fa-caret-down"></i> @Math.Round((Math.Round(hstt,1) - Math.Round(hsht,1)),1) %</span>
                            }
                            else
                            {
                                <span class="description-percentage text-success"><i class="fas fa-caret-up"></i>  @Math.Round((Math.Round(hsht, 1) - Math.Round(hstt, 1)),1) %</span>
                            }
                            <h5 class="description-header"></h5>
                            
                        </div>

                    </div>

                    <div class="col-sm-2 col-6">
                        <div class="description-block">
                            <span class="description-text">SỐ ĐƠN THÁNG NÀY </span>
                            <h5 class="description-header">@ViewBag.DaBan đơn</h5>
                            
                        </div>

                    </div>
                </div>

            </div>

        </div>

    </div>

</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>

<script src="plugins/chart.js/Chart.min.js"></script>

<script src="plugins/sparklines/sparkline.js"></script>

<script src="plugins/jqvmap/jquery.vmap.min.js"></script>
<script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>

<script src="plugins/jquery-knob/jquery.knob.min.js"></script>

<script src="plugins/moment/moment.min.js"></script>
<script src="plugins/daterangepicker/daterangepicker.js"></script>

<script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>

<script src="plugins/summernote/summernote-bs4.min.js"></script>

<script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>

<script src="dist/js/adminlte.js?v=3.2.0"></script>

<script src="dist/js/demo.js"></script>

<script src="dist/js/pages/dashboard.js"></script>


<script>
    // Giả sử bạn có mảng chứa doanh thu của 12 tháng
    var monthlyRevenue = [@ViewBag.January, @ViewBag.February, @ViewBag.March, @ViewBag.April, @ViewBag.May, @ViewBag.June, @ViewBag.July, @ViewBag.August, @ViewBag.September, @ViewBag.October, @ViewBag.November, @ViewBag.December];

    var months = [
        'Tháng 1', 'Tháng 2', 'Tháng 3', 'Tháng 4', 'Tháng 5', 'Tháng 6',
        'Tháng 7', 'Tháng 8', 'Tháng 9', 'Tháng 10', 'Tháng 11', 'Tháng 12'
    ];

    var ctx = document.getElementById('revenueChart').getContext('2d');
    var revenueChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: months,
            datasets: [{
                label: 'Doanh thu theo tháng (VND)',
                data: monthlyRevenue,
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Doanh thu (VND)'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Tháng'
                    }
                }
            }
        }
    });
</script>
